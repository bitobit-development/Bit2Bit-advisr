(()=>{var e={};e.id=6056,e.ids=[6056],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},69623:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d}),s(13560),s(48471),s(11506),s(35866);var a=s(23191),n=s(88716),r=s(37922),l=s.n(r),i=s(95231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["new-leads-self",{children:["verify-otp",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,13560)),"/home/runner/workspace/app/new-leads-self/verify-otp/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,48471)),"/home/runner/workspace/app/new-leads-self/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,11506)),"/home/runner/workspace/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/runner/workspace/app/new-leads-self/verify-otp/page.tsx"],u="/new-leads-self/verify-otp/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/new-leads-self/verify-otp/page",pathname:"/new-leads-self/verify-otp",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},79473:(e,t,s)=>{Promise.resolve().then(s.bind(s,33602))},25716:()=>{},33602:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(10326),n=s(17577),r=s(35047),l=s(90772),i=s(10937);function o(){let e=(0,r.useSearchParams)().get("mobile"),[t,s]=(0,n.useState)(""),[o,d]=(0,n.useState)(null),[c,u]=(0,n.useState)(!1),m=(0,r.useRouter)(),p=async()=>{if(e&&!(t.length<6)){u(!0),d(null);try{let s=await fetch("/api/validate_otp_clean",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mobile_number:e,otp:t}),credentials:"include"}),a=await s.json();if(a.success){console.log("✅ OTP verified");let e=JSON.parse(localStorage.getItem("lead_info")||"{}"),t=await fetch("/api/create-lead",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e.name,surname:e.surname,email:e.email,mobile:e.mobile,consent:e.consent})}),s=await t.json();s.success?(console.log("✅ Lead inserted into Supabase:",s.data),localStorage.removeItem("lead_info"),m.push("/new-leads/thank-you")):(console.error("❌ Failed to insert lead:",s.message),m.push(`/new-leads/failed?reason=${encodeURIComponent(s.details||s.message||"Lead submission failed")}`))}else d(a.message||"Invalid OTP. Please try again.")}catch(e){console.error("❌ OTP validation error:",e),d("Something went wrong. Please try again."),u(!1)}}};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-white px-4",children:(0,a.jsxs)("div",{className:"bg-white p-8 rounded-xl shadow-xl max-w-md w-full",children:[a.jsx("div",{className:"flex justify-between mb-6",children:["Sign Up","Verify OTP","Complete"].map((e,t)=>{let s=1===t;return(0,a.jsxs)("div",{className:"flex-1 text-center",children:[a.jsx("div",{className:`w-8 h-8 mx-auto mb-1 rounded-full flex items-center justify-center text-white text-sm font-bold ${s?"bg-blue-600":"bg-gray-300"}`,children:t+1}),a.jsx("span",{className:`text-sm ${s?"text-pink-600 font-medium":"text-gray-500"}`,children:e})]},e)})}),a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Verify OTP"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["We’ve sent a one-time PIN to your mobile number:"," ",a.jsx("strong",{children:e})]}),a.jsx("div",{className:"flex justify-center my-4",children:a.jsx(i.Zn,{maxLength:6,value:t,onChange:e=>s(e),children:a.jsx(i.hf,{children:[...Array(6)].map((e,t)=>a.jsx(i.cY,{index:t,className:"w-12 h-12 text-xl"},t))})})}),o&&a.jsx("p",{className:"text-sm text-red-600 mt-2",children:o}),a.jsx(l.z,{className:"mt-4 w-full",onClick:p,disabled:c||t.length<6,children:c?"Verifying...":"Verify"})]})})}function d(){return a.jsx(n.Suspense,{fallback:a.jsx("div",{children:"Loading..."}),children:a.jsx(o,{})})}},48471:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r,metadata:()=>n});var a=s(19510);s(67272);let n={title:"HOUSS - Sign Up",description:"Clean layout for signup, etc."};function r({children:e}){return console.log("✅ Public layout loaded"),a.jsx("div",{className:"min-h-screen bg-gray-100",children:e})}},13560:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(68570).createProxy)(String.raw`/home/runner/workspace/app/new-leads-self/verify-otp/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[8948,4851,2325,16],()=>s(69623));module.exports=a})();