(()=>{var e={};e.id=6461,e.ids=[6461],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},49182:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d}),a(38540),a(24465),a(11506),a(35866);var s=a(23191),n=a(88716),r=a(37922),i=a.n(r),l=a(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let d=["",{children:["vehicle-new-leads",{children:["verify-otp",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,38540)),"/home/runner/workspace/app/vehicle-new-leads/verify-otp/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,24465)),"/home/runner/workspace/app/vehicle-new-leads/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,11506)),"/home/runner/workspace/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/runner/workspace/app/vehicle-new-leads/verify-otp/page.tsx"],u="/vehicle-new-leads/verify-otp/page",m={require:a,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/vehicle-new-leads/verify-otp/page",pathname:"/vehicle-new-leads/verify-otp",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},13419:(e,t,a)=>{Promise.resolve().then(a.bind(a,69359))},18362:()=>{},69359:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var s=a(10326),n=a(17577),r=a(35047),i=a(90772),l=a(10937);function o(){let e=(0,r.useSearchParams)().get("mobile"),[t,a]=(0,n.useState)(""),[o,d]=(0,n.useState)(null),[c,u]=(0,n.useState)(!1),m=(0,r.useRouter)(),p=async()=>{if(e&&!(t.length<6)){u(!0),d(null);try{let a=await fetch("/api/validate_otp_clean",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mobile_number:e,otp:t}),credentials:"include"}),s=await a.json();if(s.success){console.log("✅ OTP verified");let e=JSON.parse(localStorage.getItem("lead_info")||"{}"),t=await fetch("/api/create-lead",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e.name,surname:e.surname,email:e.email,mobile:e.mobile,consent:e.consent})}),a=await t.json();a.success?(console.log("✅ Lead inserted into Supabase:",a.data),localStorage.removeItem("lead_info"),localStorage.setItem("new_inserted_lead",JSON.stringify(a.data[0])),m.push("/vehicle-new-leads/disc-capture")):(console.error("❌ Failed to insert lead:",a.message),m.push(`/vehicle-new-leads/failed?reason=${encodeURIComponent(a.details||a.message||"Lead submission failed")}`))}else d(s.message||"Invalid OTP. Please try again."),u(!1)}catch(e){console.error("❌ OTP validation error:",e),d("Something went wrong. Please try again."),u(!1)}}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-white px-4",children:(0,s.jsxs)("div",{className:"bg-white p-8 rounded-xl shadow-xl max-w-md w-full",children:[s.jsx("div",{className:"flex justify-between mb-6",children:["Sign Up","Verify OTP","Complete"].map((e,t)=>{let a=1===t;return(0,s.jsxs)("div",{className:"flex-1 text-center",children:[s.jsx("div",{className:`w-8 h-8 mx-auto mb-1 rounded-full flex items-center justify-center text-white text-sm font-bold ${a?"bg-blue-600":"bg-gray-300"}`,children:t+1}),s.jsx("span",{className:`text-sm ${a?"text-pink-600 font-medium":"text-gray-500"}`,children:e})]},e)})}),s.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Verify OTP"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["We’ve sent a one-time PIN to your mobile number:"," ",s.jsx("strong",{children:e})]}),s.jsx("div",{className:"flex justify-center my-4",children:s.jsx(l.Zn,{maxLength:6,value:t,onChange:e=>a(e),children:s.jsx(l.hf,{children:[...Array(6)].map((e,t)=>s.jsx(l.cY,{index:t,className:"w-12 h-12 text-xl"},t))})})}),o&&s.jsx("p",{className:"text-sm text-red-600 mt-2",children:o}),s.jsx(i.z,{className:"mt-4 w-full",onClick:p,disabled:c||t.length<6,children:c?"Verifying...":"Verify"})]})})}function d(){return s.jsx(n.Suspense,{fallback:s.jsx("div",{children:"Loading..."}),children:s.jsx(o,{})})}},24465:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r,metadata:()=>n});var s=a(19510);a(67272);let n={title:"HOUSS - Sign Up",description:"Clean layout for signup, etc."};function r({children:e}){return console.log("✅ Public layout loaded"),s.jsx("div",{className:"min-h-screen bg-gray-100",children:e})}},38540:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(68570).createProxy)(String.raw`/home/runner/workspace/app/vehicle-new-leads/verify-otp/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[8948,4851,2325,16],()=>a(49182));module.exports=s})();