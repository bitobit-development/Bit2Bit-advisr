(()=>{var e={};e.id=8852,e.ids=[8852],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},22594:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>m,tree:()=>d}),r(22945),r(11506),r(35866);var s=r(23191),a=r(88716),n=r(37922),i=r.n(n),l=r(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d=["",{children:["pre-wellness-day-reg",{children:["verify-otp",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,22945)),"/home/runner/workspace/app/pre-wellness-day-reg/verify-otp/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,11506)),"/home/runner/workspace/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/runner/workspace/app/pre-wellness-day-reg/verify-otp/page.tsx"],p="/pre-wellness-day-reg/verify-otp/page",u={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/pre-wellness-day-reg/verify-otp/page",pathname:"/pre-wellness-day-reg/verify-otp",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},16614:(e,t,r)=>{Promise.resolve().then(r.bind(r,14965))},14965:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(10326),a=r(17577),n=r(17406),i=r(35047),l=r(90772),o=r(10937),d=r(77506),c=r(77863),p=r(46226);function u(){let e=(0,i.useRouter)(),t=(0,i.useSearchParams)().get("mobile"),[r,u]=(0,a.useState)(""),[m,h]=(0,a.useState)(null),[x,f]=(0,a.useState)(!1),[y,g]=(0,a.useState)(0),b=e=>(0,c.cn)("w-8 h-8 mx-auto mb-1 rounded-full flex items-center justify-center text-white text-sm font-bold",e?"bg-blue-600":"bg-gray-300"),v=e=>(0,c.cn)("text-sm leading-tight",e?"":"text-gray-500"),j=async()=>{if(h(null),y>=1){h("Please call the broker directly if you did not receive the code.");return}g(1);try{await fetch("/api/send_otp_clean",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({mobile_number:t})}),h("A new code has been sent.")}catch{h("Failed to resend. Please call the broker directly.")}},w=async()=>{if(!t||r.length<6)return;f(!0),h(null);let s=await fetch("/api/validate_otp_clean",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({mobile_number:t,otp:r})}),{success:a,message:i}=await s.json();if(!a){h(i||"Invalid OTP. Please try again."),f(!1);return}let l=JSON.parse(localStorage.getItem("lead_info")||"{}"),o=await fetch("/api/create-pre-event-lead",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:l.name,surname:l.surname,email:l.email,mobile:l.mobile,is_discovery_customer:l.isDiscoveryCustomer,has_vitality:l.hasVitality,products:l.products,consent:l.consent})}),{success:d,data:c}=await o.json();if(!d){e.push(n.Z6.failed("Lead insert failed"));return}let{lead_code:p}=c[0],u=`Hi ${l.name}, your ref no. is ${p}. See you at the Wellness Day!

Carla Prinsloo (0829215785)
Your Senior Financial Advisor
Discovery LTD.`;await fetch("/api/send_sms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phoneNumber:t,messageContent:u})}),localStorage.setItem("lead_code",p),e.push(n.Z6.thankYou())};return s.jsx("div",{className:"min-h-screen flex items-center justify-center px-4",children:(0,s.jsxs)("div",{className:"bg-white p-8 rounded-xl max-w-md w-full text-center relative pt-16",style:{boxShadow:"0 4px 10px rgba(230, 0, 126, 0.25)"},children:[s.jsx(p.default,{src:"/Vitality-Pink-logo.svg",alt:"Vitality Logo",width:100,height:35,className:"absolute top-4 left-4",priority:!0}),s.jsx("div",{className:"w-full max-w-[700px] mx-auto flex justify-between mb-6 pt-3",children:["Register Details","Verify Your Number","All Set!"].map((e,t)=>{let r=1===t;return(0,s.jsxs)("div",{className:"flex-1 text-center px-2",children:[" ",s.jsx("div",{className:b(r),children:t+1}),s.jsx("span",{className:(0,c.cn)(v(r),"whitespace-nowrap"),style:{color:r?"#EB2660":void 0},children:e})]},e)})}),s.jsx("h1",{className:"text-3xl font-semibold text-[#eb2660] mb-4 uppercase",children:"Verify OTP"}),(0,s.jsxs)("p",{className:"text-base text-[#666666] mb-4",children:["Enter the one-time PIN sent to ",s.jsx("strong",{className:"font-semibold",children:t})]}),s.jsx("div",{className:"flex justify-center my-4",children:s.jsx(o.Zn,{maxLength:6,value:r,onChange:u,children:s.jsx(o.hf,{children:Array.from({length:6}).map((e,t)=>s.jsx(o.cY,{index:t,className:"w-12 h-12 text-xl"},t))})})}),m&&s.jsx("p",{className:"text-sm text-red-600 mt-2",children:m}),s.jsx(l.z,{className:"w-full mb-2 flex items-center justify-center gap-2",disabled:x||r.length<6,onClick:w,children:x?(0,s.jsxs)(s.Fragment,{children:[s.jsx(d.Z,{className:"animate-spin w-4 h-4"}),"Verifying…"]}):"Verify"}),s.jsx("div",{className:"w-full text-left",children:s.jsx(l.z,{variant:"link",className:"text-xs text-[#eb2660] text",onClick:j,disabled:y>=1||x,children:0===y?"Resend OTP":"Call broker for help"})})]})})}function m(){return s.jsx(a.Suspense,{fallback:s.jsx("div",{children:"Loading…"}),children:s.jsx(u,{})})}},17406:(e,t,r)=>{"use strict";r.d(t,{Z6:()=>a,bS:()=>n});let s="pre-wellness-day-reg",a={landing:()=>`/${s}/`,registration:()=>`/${s}/registration`,verifyOtp:e=>`/${s}/verify-otp?mobile=${encodeURIComponent(e.replace(/\s|-/g,""))}`,thankYou:()=>`/${s}/thank-you`,failed:e=>`/${s}/failed?reason=${encodeURIComponent(e)}`},n={registration:()=>a.registration(),verifyOtp:e=>a.verifyOtp(e),thankYou:()=>a.thankYou(),failed:e=>a.failed(e)}},77506:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(62881).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},22945:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(68570).createProxy)(String.raw`/home/runner/workspace/app/pre-wellness-day-reg/verify-otp/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,4851,2325,6226,16],()=>r(22594));module.exports=s})();