(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8495],{1289:function(e,t,r){Promise.resolve().then(r.bind(r,4239))},4239:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var s=r(7437),n=r(2265),a=r(2869),i=r(5186);function l(){let e=(0,n.useRef)(null),t=(0,n.useRef)(null),[r,l]=(0,n.useState)(null),[o,d]=(0,n.useState)(!1),[c,u]=(0,n.useState)(!1),m=()=>{let e=navigator.userAgent.toLowerCase(),t=/mobile|android|iphone|ipod|blackberry|windows phone/i.test(e),r=/ipad|tablet/i.test(e);u(t||r)},f=async()=>{if(c)try{var t;(null===(t=e.current)||void 0===t?void 0:t.srcObject)&&e.current.srcObject.getTracks().forEach(e=>e.stop());let r=await navigator.mediaDevices.getUserMedia({video:{facingMode:{exact:"environment"}}});e.current&&(e.current.srcObject=r)}catch(e){console.error("Error accessing camera:",e)}};return(0,n.useEffect)(()=>{m(),c&&f();let e=localStorage.getItem("scanned_disc_image");e&&l(e)},[c]),(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-white px-4",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-xl max-w-md w-full",children:[(0,s.jsx)("div",{className:"flex justify-between mb-6",children:["Sign Up","Verify OTP","Upload ID","Scan Disc"].map((e,t)=>{let r=3===t;return(0,s.jsxs)("div",{className:"flex-1 text-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 mx-auto mb-1 rounded-full flex items-center justify-center text-white text-sm font-bold\n                  ".concat(r?"bg-blue-600":"bg-gray-300"),children:t+1}),(0,s.jsx)("span",{className:"text-sm ".concat(r?"text-pink-600 font-medium":"text-gray-500"),children:e})]},e)})}),(0,s.jsx)("h1",{className:"text-xl font-bold mb-2",children:"Scan Your License Disc"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Hold your phone steady and align the disc within the circle. Or upload an existing image below."}),c&&(0,s.jsxs)("div",{className:"relative w-full aspect-square mb-4 overflow-hidden rounded-md border shadow",children:[(0,s.jsx)("video",{ref:e,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,s.jsx)("div",{className:"w-48 h-48 rounded-full border-4 border-white/70"})})]}),r?(0,s.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,s.jsx)(a.z,{onClick:()=>{l(null),c&&f()},variant:"secondary",className:"flex-1",children:"Try Again"}),(0,s.jsx)(a.z,{onClick:()=>{r&&!o&&(d(!0),console.log("\uD83D\uDCE4 Submitting base64 to backend...",r),fetch("/api/decode_image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mobile:"0823292438",image:r})}).then(e=>e.json()).then(e=>{if(e.success){alert("Disc submitted and decoded successfully!");let t=JSON.parse(localStorage.getItem("new_inserted_lead")||"{}");t.disc_details=e,localStorage.setItem("new_inserted_lead",JSON.stringify(t))}else e.message.includes("No barcode detected")?alert("No barcode detected. Please ensure the disc is properly aligned and try again."):alert("Failed to submit image. Reason: ".concat(e.message)),console.log("Error:",e.message)}).catch(e=>{alert("An unexpected error occurred. Please try again."),console.error("Error:",e)}).finally(()=>{d(!1)}))},className:"flex-1",disabled:o,children:"Submit"})]}):(0,s.jsx)(a.z,{onClick:()=>{let r=e.current,s=t.current;if(!r||!s)return;let n=s.getContext("2d");if(!n)return;let a=r.videoWidth,i=r.videoHeight;s.width=a,s.height=i,n.drawImage(r,0,0,a,i);let o=.25*Math.min(a,i),d=a/2,c=i/2,u=2*o,m=document.createElement("canvas");m.width=u,m.height=u;let f=m.getContext("2d");if(!f)return;f.drawImage(s,d-o,c-o,u,u,0,0,u,u);let g=m.toDataURL("image/jpeg");l(g),console.log("\uD83C\uDFAF Cropped disc base64:",g),localStorage.setItem("scanned_disc_image",g)},className:"w-full mb-4",disabled:o,children:"Capture Disc"}),(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)(i.I,{type:"file",accept:"image/*",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!r)return;let s=new FileReader;s.onloadend=()=>{let e=s.result;l(e),localStorage.setItem("scanned_disc_image",e)},s.readAsDataURL(r)},className:"text-sm",disabled:o})}),(0,s.jsx)("canvas",{ref:t,className:"hidden"}),r&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("h3",{className:"font-medium text-sm mb-2",children:"Preview:"}),(0,s.jsx)("img",{src:r,alt:"Disc preview",className:"w-full rounded-md shadow"})]})]})})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return d}});var s=r(7437),n=r(2265),a=r(7053),i=r(535),l=r(4508);let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:r,variant:n,size:i,asChild:d=!1,...c}=e,u=d?a.g7:"button";return(0,s.jsx)(u,{className:(0,l.cn)(o({variant:n,size:i,className:r})),ref:t,...c})});d.displayName="Button"},5186:function(e,t,r){"use strict";r.d(t,{I:function(){return i}});var s=r(7437),n=r(2265),a=r(4508);let i=n.forwardRef((e,t)=>{let{className:r,type:n,...i}=e;return(0,s.jsx)("input",{type:n,className:(0,a.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},4508:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var s=r(1994),n=r(3335);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,s.W)(t))}}},function(e){e.O(0,[5569,2971,2117,1744],function(){return e(e.s=1289)}),_N_E=e.O()}]);